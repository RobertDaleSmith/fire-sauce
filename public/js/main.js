/*! Fire-Sauce-TV 2015-07-30 */
function fadeSplash(){setTimeout(function(){$("#splash_wrapper .logo .iris").removeClass("spinning"),$("#splash_wrapper").addClass("done"),setTimeout(function(){$("#splash_wrapper").css("display","none")},500)},100)}function loadPopularSuggestions(){getPopRequest&&getPopRequest.abort(),getPopRequest=$.getJSON("/popular",function(a){for(var b=0;b<a.length;b++){var c=a[b].name;suggestCache[c]=a[b],suggestCache[c].suggested=!0}})}function showSearchSpinner(){$("#searching_wrapper").addClass("searching"),$("#channel_info_wrapper .spinner").addClass("rotating")}function hideSearchSpinner(){$("#searching_wrapper").removeClass("searching"),window.clearTimeout(spinnerTimer),spinnerTimer=setTimeout(function(){$("#channel_info_wrapper .spinner").removeClass("rotating")},250)}function showFailedAlert(a){$("#failed_wrapper").addClass("failed"),$("#failed_message").text(a),window.clearTimeout(alertTimer),alertTimer=setTimeout(function(){hideFailedAlert()},5e3)}function hideFailedAlert(){$("#failed_wrapper").removeClass("failed")}function watchUsername(a){a=a.toLowerCase(),showSearchSpinner();var b=null;if(hist.channels[a]&&hist.channels[a].trackList.length>0){console.log("Previously watched.. Pulling only since last id.");var c=hist.channels[a].trackList.length;b=hist.channels[a].trackList[c-1].id,tracksLoaded=0,$("#schedule_wrapper").html(""),renderTracks(hist.channels[a].trackList),hist.write("watching",a.toLowerCase()),getTwitterUserInfo(a,updateChannelInfo)}searchRequest&&searchRequest.abort();var d="/channel/tracks/?screen_name="+a;b&&(d=d+"&since_id="+b),searchRequest=$.getJSON(d,function(c){if(!c.error&&c.trackList){var d=c.trackList||[];if(hideSearchSpinner(),hideFailedAlert(),d.length>0){ga("send","event","watch","screen_name",a),hist.write("watching",a.toLowerCase()),b||(tracksLoaded=0,$("#schedule_wrapper").html(""),hist.channels.write(hist.watching,{trackList:[]})),c.info&&hist.channels[hist.watching].write("info",c.info),getTwitterUserInfo(a,updateChannelInfo);for(var e=0;e<d.length;e++)hist.channels[hist.watching].trackList.push(d[e]);renderTracks(d),trackIndex=d.length,playMostRecentUnfinished()}else console.log("No new vids found..."),showFailedAlert("No new videos found."),b&&(hist.channels[hist.watching].trackIndex>=0?(trackIndex=hist.channels[hist.watching].trackIndex,playTrack(trackIndex)):(trackIndex=d.length,playMostRecentUnfinished()));$(".btn.watching").hasClass("active")||$(".btn.watching").click()}else hideSearchSpinner(),showFailedAlert("No recent video Tweets."),console.log("No recent video Tweets.")}).fail(function(a,b,c){hideSearchSpinner(),showFailedAlert("Server may be down. :( "),console.log(b+": "+c)})}function updateChannelInfo(a){hist.channels[hist.watching]&&(hist.channels[hist.watching].followed?$("#channel_info_wrapper").addClass("followed"):$("#channel_info_wrapper").removeClass("followed")),$("#channel_info_wrapper").removeClass("default"),$("#channel_info_wrapper").css("display",""),$("#channel_info_wrapper .avatar").attr("src",a.profile_image_url.replace("http:","")),$("#channel_info_wrapper .profile_link").attr("href","https://twitter.com/intent/user?screen_name="+a.screen_name),$("#channel_info_wrapper .name").text(a.name),$("#channel_info_wrapper .screen_name").text("@"+a.screen_name),$("input#search_input").val(a.screen_name),updateTweetOverLayWidth();var b=a.screen_name.toLowerCase();$("#history_wrapper .channel").removeClass("active"),$("#channel__"+b).addClass("active"),$("#channel__"+b+" .avatar").attr("src",a.profile_image_url.replace("http:","")),$("#channel__"+b+" .name").text(a.name),$("#channel__"+b+" .screen_name").text("@"+a.screen_name),location.hash="/"+a.screen_name}function updateTweetOverLayWidth(){var a=40+parseInt($("#channel_info_wrapper").css("width").replace("px",""))+parseInt($("#channel_info_wrapper").css("left").replace("px",""));$("#track_tweet_wrapper").css("max-width","calc(100% - "+a+"px)")}function renderTracks(a){$.each(a,function(a,b){var c=$("<li/>").addClass("track").attr("id","video__"+tracksLoaded).append($("<div/>").addClass("indicator")).append($("<div/>").addClass("progress")).append($("<a/>").addClass("started").attr("href","http://twitter.com/"+b.user.screen_name+"/status/"+b.id).attr("target","_blank").append($("<span/>").addClass("fromNow").text(moment(new Date(b.created_at)).fromNow())).append($("<span/>").addClass("exactDate").text(moment(new Date(b.created_at)).format("llll")))).append($("<div/>").addClass("text").html(twemoji.parse(b.text.linkify_tweet()))).append($("<div/>").addClass("controls").append($("<div/>").addClass("btn pause").html("<i class='fa fa-pause'></i>").attr("title","Pause")).append($("<div/>").addClass("btn start").html("<i class='fa fa-play'></i>").attr("title","Start")).append($("<div/>").addClass("group social").append($("<a>").addClass("btn right fav").html("<i class='fa fa-star'></i>").attr("title","Diamond in the rough").attr("href","https://twitter.com/intent/favorite?tweet_id="+b.id+"&related=firesaucetv")).append($("<a>").addClass("btn right resauce").html("<i class='fa fa-retweet'></i>").attr("title","Resauce to your stream").attr("href","https://twitter.com/intent/retweet?tweet_id="+b.id+"&related=firesaucetv")).append($("<a>").addClass("btn right reply").html("<i class='fa fa-reply'></i>").attr("title","Say something about it").attr("href","https://twitter.com/intent/tweet?in-reply-to="+b.id+"&related=firesaucetv%3AFire%20Sauce.TV&url="+b.url.replace("https://","http://").replace("http://www.youtube.com/watch?v=","http://youtu.be/")+"&via="+b.user+"&hashtags=firesaucetv"))));c.bind("click",function(a){function b(a){for(var b=0;b<e.length;b++)if(a.indexOf(e[b])>-1)return!0;return!1}var c=this,d=$(a.toElement).attr("class"),e=["fa","btn","link","channel","exactDate"];if(!b(d)){var f;f=$(a.toElement).hasClass("track")?$(a.toElement):$(a.toElement).closest("li.track"),f.hasClass("playing")?videoPauseClickEvent(a,c):videoStartClickEvent(a,c)}}),c.find(".btn.start").bind("click",videoStartClickEvent),c.find(".btn.pause").bind("click",videoPauseClickEvent),c.find(".btn.fav").bind("click",videoFavClickEvent),c.find(".btn.resauce").bind("click",videoResauceClickEvent),b.percent>=0&&c.find("div.progress").attr("style","width: "+b.percent+"%"),b.retweeted&&c.find("a.resauce").addClass("resauced"),b.favorited&&c.find("a.fav").addClass("diamond"),b.watched&&c.addClass("watched"),b.skipped&&c.addClass("skipped"),b.error&&(c.addClass("error"),c.find(".text .errMsg").remove(),c.find(".text").append($("<span/>").addClass("errMsg").html("Embedded video unable to play."))),$("#schedule_wrapper").append(c),tracksLoaded++}),scrollToTrack()}function onYouTubeIframeAPIReady(){ytplayerReady=!0,setInterval(updatePlayerInfo,1e3)}function initYouTubeIframeAPI(a,b){ytplayerReady&&(ytIframeAPIReady=!0,ytplayer=new YT.Player("ytplayer",{height:"100%",width:"100%",videoId:a,playerVars:{autohide:1,start:parseInt(b),cc_load_policy:0,controls:1,enablejsapi:1,disablekb:1,fs:1,html5:1,iv_load_policy:3,modestbranding:1,origin:window.location.host,playsinline:1,rel:0,theme:"dark",showinfo:1},events:{onReady:onYtPlayerReady,onError:onYtPlayerError,onStateChange:onYtPlayerStateChange}}))}function onYtPlayerReady(a){a.target.playVideo()}function onYtPlayerStateChange(a){playerState=a.data,a.data==YT.PlayerState.ENDED?(console.log("ENDED"),hist.channels[hist.watching].trackList[trackIndex].write("watched",!0),hist.channels[hist.watching].trackList[trackIndex].write("skipped",null),hist.channels[hist.watching].trackList[trackIndex].write("percent",100),$("li.track#video__"+trackIndex).css("width","").addClass("watched").find("div.progress").attr("style",""),playNextTrack()):a.data==YT.PlayerState.PLAYING?(console.log("PLAYING"),hist.channels[hist.watching].trackList[trackIndex].write("started",!0),hist.channels[hist.watching].trackList[trackIndex].write("skipped",null),hist.channels[hist.watching].write("trackIndex",trackIndex),hist.channels[hist.watching].write("lastWatched",(new Date).toString()),hist.channels[hist.watching].trackList[trackIndex].error&&(hist.channels[hist.watching].trackList[trackIndex].erase("error"),$("li.track#video__"+trackIndex).removeClass("error"),$("li.track#video__"+trackIndex+" .text .errMsg").remove()),$("#timeSlider").slider("option","max",ytplayer.getDuration()),$("li.track.playing div.btn.pause i.fa").removeClass("fa-play").addClass("fa-pause"),$("li.track.playing div.btn.pause").attr("title","Pause")):a.data==YT.PlayerState.PAUSED?(console.log("PAUSED"),$("li.track.playing div.btn.pause i.fa").removeClass("fa-pause").addClass("fa-play"),$("li.track.playing div.btn.pause").attr("title","Play")):a.data==YT.PlayerState.BUFFERING?(console.log("BUFFERING"),setTimeout(function(){playVideo()},1e3)):a.data==YT.PlayerState.CUED&&console.log("CUED")}function onYtPlayerError(a){console.log("Error: "+a.data),(150==a.data||2==a.data)&&hist.channels[hist.watching].trackList[trackIndex].write("error",a.data),$("li.track#video__"+trackIndex).addClass("error"),$("li.track#video__"+trackIndex+" .text .errMsg").remove(),$("li.track#video__"+trackIndex+" .text").append($("<span/>").addClass("errMsg").html("Embedded video unable to play.")),playNextTrack()}function seekVideoTo(a,b){ytplayer.seekTo(a,b)}function playVideo(){ytplayer.playVideo()}function pauseVideo(){ytplayer.pauseVideo()}function stopVideo(){ytplayer.stopVideo(),ytplayer.clearVideo()}function loadVideo(a,b){b||(b=0),playerState=0,ytIframeAPIReady?ytplayer.loadVideoById(a,b,"large"):initYouTubeIframeAPI(a,b)}function setVolume(a){a>100?a=100:0>a&&(a=0),ytplayer.setVolume(a)}function getVolume(a){return ytplayer.getVolume()}function toggleMute(a){ytplayer.isMuted()?ytplayer.unMute():ytplayer.mute()}function getYouTubeID(a){var b=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,c=a.match(b);return c&&11==c[7].length?c[7]:""}function getVimeoID(a){var b=/vimeo.*\/(\d+)/i.exec(a);return b?b[1]:void 0}function playNextTrack(){trackIndex--,playerState=0,playTrack(trackIndex)}function playMostRecentUnfinished(){for(var a=hist.channels[hist.watching].trackList.length,b=a-1;b>=0;b--){if(!hist.channels[hist.watching].trackList[b].watched&&(!hist.channels[hist.watching].trackList[b].skipped||trackIndex>b)&&!hist.channels[hist.watching].trackList[b].error){playTrack(b);break}0==b&&playMostRecentSkipped()}}function playMostRecentSkipped(){for(var a=hist.channels[hist.watching].trackList.length,b=a-1;b>=0;b--){if(!hist.channels[hist.watching].trackList[b].watched&&hist.channels[hist.watching].trackList[b].skipped&&!hist.channels[hist.watching].trackList[b].error){playTrack(b);break}0==b&&loopEnabled&&playTrack(trackIndex)}}function playTrack(a){try{var b=getYouTubeID(hist.channels[hist.watching].trackList[a].url),c=hist.channels[hist.watching].trackList[a].percent||0,d=hist.channels[hist.watching].trackList[a].time||0;if(c>=100&&(d=0),ga("send","event","video","play",b),ga("send","event","video","view",hist.watching),trackIndex=a,a>=0){var e=hist.channels[hist.watching].trackList[a];console.log("Starting next track... "+a+" : "+e.url),$.post("/channel/tracks?screen_name="+hist.watching+"&track_id="+e.id),loadVideo(b,d)}$("li.track").removeClass("playing"),$("li.track#video__"+a).addClass("playing"),scrollToTrack(),$(".track .controls .btn.start .fa").removeClass("fa-repeat").addClass("fa-play"),$(".track .controls .btn.start").attr("title","Start"),$(".track .controls .btn.start").removeClass("restart"),$("#video__"+a+" .btn.start .fa").removeClass("fa-play").addClass("fa-repeat"),$("#video__"+a+" .btn.start").attr("title","Restart"),$("#video__"+a+" .btn.start").addClass("restart"),$("#track_tweet_wrapper span.text").html(hist.channels[hist.watching].trackList[a].text.linkify_tweet())}catch(f){console.log("error caught for playTrack("+a+")")}}function scrollToTrack(){if($("#schedule_wrapper .playing")&&$("#schedule_wrapper .playing").offset()){var a=$("#watch_wrapper").offset().top;$("#schedule_wrapper").animate({scrollTop:$("#schedule_wrapper").scrollTop()+$("#schedule_wrapper .playing").offset().top-a},500)}}function videoStartClickEvent(a,b){var c;if(b||(b=this),c=$(a.toElement).hasClass("track")?$(a.toElement):$(a.toElement).closest("li.track"),$(b).hasClass("restart"))seekVideoTo(0),playVideo();else{var d=parseInt(c.attr("id").replace("video__",""));trackIndex>=0&&hist.channels[hist.watching].trackList[trackIndex].write("skipped",!0),playTrack(d)}}function videoPauseClickEvent(a,b){b||(b=this),1==playerState?pauseVideo():(playVideo(),$("li.track.playing div.btn.pause i.fa").removeClass("fa-play").addClass("fa-pause"))}function videoFavClickEvent(a){var b=$(this).parent().parent().parent().attr("id");b=b.replace("video__",""),b=parseInt(b),$(this).hasClass("diamond")?($(this).removeClass("diamond"),hist.channels[hist.watching].trackList[b].write("favorited",!1)):($(this).addClass("diamond"),hist.channels[hist.watching].trackList[b].write("favorited",!0))}function videoResauceClickEvent(a){var b=$(this).parent().parent().parent().attr("id");b=b.replace("video__",""),b=parseInt(b),$(this).hasClass("resauced")?($(this).removeClass("resauced"),hist.channels[hist.watching].trackList[b].write("retweeted",!1)):($(this).addClass("resauced"),hist.channels[hist.watching].trackList[b].write("retweeted",!0))}function getTwitterUserInfo(a,b){if(hist.channels[hist.watching]&&hist.channels[hist.watching].info)return b(hist.channels[hist.watching].info),hist.channels[hist.watching].info;getUserRequest&&getUserRequest.abort();var c="/channel/?screen_name="+a;getUserRequest=$.getJSON(c,function(a){console.log("Fetched Twitter user's data"),a&&hist.channels[hist.watching].write("info",a),b&&b(a)})}function updatePlayerInfo(){ytplayer&&1==playerState&&(fractionLoaded=ytplayer.getVideoLoadedFraction(),tempCurrentTime=ytplayer.getCurrentTime(),tempDuration=ytplayer.getDuration(),completedPercent=(100*tempCurrentTime/tempDuration).toFixed(2),$("li.track#video__"+trackIndex+" .progress").css("width",completedPercent+"%"),hist.channels[hist.watching].trackList[trackIndex]&&(hist.channels[hist.watching].trackList[trackIndex].write("percent",completedPercent),hist.channels[hist.watching].trackList[trackIndex].write("time",tempCurrentTime)),timeSeeking||($("#timeSlider").slider("value",tempCurrentTime),currentTimeOutput=secondsToTime(tempCurrentTime),document.getElementById("timer_current").innerHTML=currentTimeOutput),durationTimeOutput=secondsToTime(tempDuration),document.getElementById("timer_duration").innerHTML=durationTimeOutput,prevCurrentTime=tempCurrentTime,prevDuration=tempDuration)}function renderHistory(a){$("#suggested_wrapper").html("").css("display",""),$("#followed_wrapper").html("").css("display",""),$("#watched_wrapper").html("").css("display","");var b=0,c=0,d=0,e=JSON.parse(JSON.stringify(suggestCache)),f=[];for(var g in a)"_rhaboo"!=g&&(a[g].name=g,a[g].name?f.push(a[g]):hist.channels.erase(g),delete e[g]);for(var h in e)f.unshift(e[h]);f.sort(function(a,b){return new Date(a.lastWatched)-new Date(b.lastWatched)}),$.each(f,function(a,e){if(e.info){e.trackList||(e.trackList=[]);var f=$("<li/>").addClass("channel").attr("id","channel__"+e.name).attr("channel",e.name).append($("<div/>").addClass("status")).append($("<div/>").addClass("options").append($("<div/>").addClass("btn delete").html('<i class="fa fa-remove"></i>'))).append($("<div/>").addClass("info").append($("<img>").addClass("avatar").attr("src",e.info.profile_image_url.replace("http:",""))).append($("<div/>").addClass("name").html(e.info.name)).append($("<div/>").addClass("screen_name").html("@"+e.info.screen_name)).append($("<div/>").addClass("views").html("&nbsp;"+getWatchedCount(e.trackList)+" / "+e.trackList.length+"&nbsp;"))).append($("<input>").addClass("follow").attr("type","button").val("FOLLOW"));f.find("div.info").bind("click",function(){var a=$(this).parent().attr("channel");watchUsername(a)}),f.find("div.info").bind("contextmenu",function(a){$(this).parent().hasClass("suggested")||(a.preventDefault(),$(this).parent().toggleClass("edit"))}),f.find("div.info").bind("swiperight",function(a){$(this).parent().hasClass("suggested")||(a.preventDefault(),console.log("swiperight"),$(this).parent().addClass("edit"))}),f.find("div.info").bind("swipeleft",function(a){$(this).parent().hasClass("suggested")||(a.preventDefault(),console.log("swipeleft"),$(this).parent().removeClass("edit"))}),f.find("div.btn.delete").bind("click",function(){var a=$(this).parent().parent().attr("channel");console.log("delete "+a),hist.channels.erase(a),$(this).parent().parent().remove()}),f.find("input.follow").bind("click",function(){var a=$(this).parent().attr("channel");$(this).parent().hasClass("followed")?($(this).parent().removeClass("followed"),$(this).val("FOLLOW"),hist.channels[a].write("followed",!1),hist.watching==a&&$("#channel_info_wrapper").removeClass("followed")):($(this).parent().addClass("followed"),$(this).val("FOLLOWED"),hist.channels[a].write("followed",!0),hist.watching==a&&$("#channel_info_wrapper").addClass("followed"))}),e.followed&&(f.addClass("followed"),f.find("input.follow").val("FOLLOWED")),e.suggested&&f.addClass("suggested"),e.name==hist.watching&&f.addClass("active"),e.suggested?($("#suggested_wrapper").prepend(f),b++):e.followed?($("#followed_wrapper").prepend(f),c++):($("#watched_wrapper").prepend(f),d++)}else console.log("Channel data error.. skipping.")}),1>b&&$("#suggested_wrapper").css("display","none"),1>c&&$("#followed_wrapper").css("display","none"),1>d&&$("#watched_wrapper").css("display","none")}function renderChannels(a){$("#top100_wrapper").html("").css("display","");var b=0;$.each(sortable,function(a,b){b.trackList||(b.trackList=[]);var c=$("<li/>").addClass("channel").attr("id","channel__"+b.name).attr("channel",b.name).append($("<div/>").addClass("status")).append($("<div/>").addClass("options").append($("<div/>").addClass("btn delete").html('<i class="fa fa-remove"></i>'))).append($("<div/>").addClass("info").append($("<img>").addClass("avatar").attr("src",b.info.profile_image_url.replace("http:",""))).append($("<div/>").addClass("name").html(b.info.name)).append($("<div/>").addClass("screen_name").html("@"+b.info.screen_name)).append($("<div/>").addClass("views").html("&nbsp;"+getWatchedCount(b.trackList)+" / "+b.trackList.length+"&nbsp;"))).append($("<input>").addClass("follow").attr("type","button").val("FOLLOW"));c.find("div.info").bind("click",function(){var a=$(this).parent().attr("channel");watchUsername(a)}),c.find("div.info").bind("contextmenu",function(a){$(this).parent().hasClass("suggested")||(a.preventDefault(),$(this).parent().toggleClass("edit"))}),c.find("div.info").bind("swiperight",function(a){$(this).parent().hasClass("suggested")||(a.preventDefault(),console.log("swiperight"),$(this).parent().addClass("edit"))}),c.find("div.info").bind("swipeleft",function(a){$(this).parent().hasClass("suggested")||(a.preventDefault(),console.log("swipeleft"),$(this).parent().removeClass("edit"))}),c.find("div.btn.delete").bind("click",function(){var a=$(this).parent().parent().attr("channel");console.log("delete "+a),hist.channels.erase(a),$(this).parent().parent().remove()}),c.find("input.follow").bind("click",function(){var a=$(this).parent().attr("channel");$(this).parent().hasClass("followed")?($(this).parent().removeClass("followed"),$(this).val("FOLLOW"),hist.channels[a].write("followed",!1),hist.watching==a&&$("#channel_info_wrapper").removeClass("followed")):($(this).parent().addClass("followed"),$(this).val("FOLLOWED"),hist.channels[a].write("followed",!0),hist.watching==a&&$("#channel_info_wrapper").addClass("followed"))}),b.followed&&(c.addClass("followed"),c.find("input.follow").val("FOLLOWED")),b.suggested&&c.addClass("suggested"),b.name==hist.watching&&c.addClass("active"),$("#top100_wrapper").prepend(c)}),1>b&&$("#top100_wrapper").css("display","none")}function getWatchedCount(a){var b=0;for(var c in a)b+=a[c].watched?1:0;return b}var ua=navigator.userAgent.toLowerCase(),isAndroid=ua.indexOf("android")>-1;$(window).bind("load",function(){$("input#search_input").bind("keydown",function(a){(a.keyCode>=48&&a.keyCode<=90||a.keyCode>=96&&a.keyCode<=105||189==a.keyCode)&&(a.altKey||a.ctrlKey||a.metaKey||(this.selectionStart==this.selectionEnd?15==this.value.length&&a.preventDefault():189!=a.keyCode||a.shiftKey||a.preventDefault())),13==a.keyCode&&$("div#search_button").click()}),$("input#search_input").bind("paste",function(a){a.preventDefault();var b=a.originalEvent.clipboardData.getData("text/plain"),c=/[^a-z0-9_]/gi,d=b;if(c.test(d)&&(b=d.replace(c,"")),this.selectionStart==this.selectionEnd)15!=this.value.length&&insertAtCaret("search_input",b);else{var e=this.selectionStart,f=this.selectionEnd-this.selectionStart+(15-this.value.length),g=b.substring(0,f),h=this.value;h=h.slice(0,this.selectionStart)+h.slice(this.selectionEnd),this.value=h,this.setSelectionRange(e,e),insertAtCaret("search_input",g)}}),$("input#search_input").bind("input",function(a){var b=this.selectionStart,c=/[^a-z0-9_]/gi,d=$(this).val();c.test(d)&&($(this).val(d.replace(c,"")),b--),this.value.length>15&&(this.value=this.value.slice(0,-1)),isAndroid||this.setSelectionRange(b,b)}),$("div#search_button").bind("click",function(a){var b=$("input#search_input").val();b.length>0&&(console.log("fire: "+b),ga("send","event","search","screen_name",b),watchUsername(b),hideFailedAlert())}),$("input#cancel_search_button").bind("click",function(a){hideSearchSpinner(),searchRequest&&searchRequest.abort()}),$("input#close_failed_button").bind("click",function(a){hideFailedAlert()}),$("#player_watermark").bind("click",function(a){trackIndex>=0&&(hist.channels[hist.watching].trackList[trackIndex].write("skipped",!0),playMostRecentUnfinished())}),$("#timeSlider").slider({animate:"fast",orientation:"horizontal",range:"min",min:0,max:100,value:0,start:function(){timeSeeking=!0},slide:function(){$("#timeSlider").slider("value")},stop:function(){var a=$("#timeSlider").slider("value");seekVideoTo(a,!0),setTimeout(function(){timeSeeking=!1},100)},change:function(){}}),$("#channel_info_wrapper .click_area, #channel_info_wrapper .follow_btn").bind("click",function(a){var b=$(this).parent();b.hasClass("default")||(b.hasClass("followed")?(b.removeClass("followed"),$("#channel__"+hist.watching).removeClass("followed"),$("#channel__"+hist.watching+" .follow").val("FOLLOW"),hist.channels[hist.watching].write("followed",!1)):(b.addClass("followed"),$("#channel__"+hist.watching).addClass("followed"),$("#channel__"+hist.watching+" .follow").val("FOLLOWED"),hist.channels[hist.watching].write("followed",!0)))}),$("#titlebar_wrapper .btn").bind("click",function(a){var b=$(this).attr("for");$(this).hasClass("active")?"watch_wrapper"==b&&scrollToTrack():($("#titlebar_wrapper .btn").removeClass("active"),$(this).addClass("active"),$("#chrome_wrapper .panel").css("display","none"),$("#chrome_wrapper .panel#"+b).css("display",""),"history_wrapper"==b?renderHistory(hist.channels):"watch_wrapper"==b?scrollToTrack():"channels_wrapper"==b&&scrollToTrack())}),$("#toggle_sidebar_btn").bind("click",function(a){$("#main_wrapper").hasClass("side_open")?$("#main_wrapper").removeClass("side_open"):$("#main_wrapper").addClass("side_open")}),$("#twitter_signin_btn").bind("click",function(a){$("#titlebar_wrapper .btn.watching").click()}),$("#twitter_signout_btn").bind("click",function(a){pauseVideo()}),$("div#clear_history").bind("click",function(a){window.localStorage.clear(),window.location.href="/"});var a=location.hash||"";a=a.replace("#/","").replace("#","");var b=/[^a-z0-9_]/gi,c=a;b.test(c)&&(a=c.replace(b,"")),a=a.toLowerCase(),a.length>0&&watchUsername(a),$(window).on("hashchange",function(){var a=location.hash.replace("#/","").replace("#","")||"";a=a.toLowerCase();var b=hist.watching||null;b=b.toLowerCase(),a!=b&&watchUsername(a)}),loadPopularSuggestions(),fadeSplash()});var isPortrait=null;window.onresize=function(a){var b=null;b=window.innerHeight>window.innerWidth?!0:!1,b!=isPortrait&&updateTweetOverLayWidth(),isPortrait=b};var suggestCache={},spinnerTimer,alertTimer,searchRequest,getUserRequest,getPopRequest,trackIndex=-1,tracksLoaded=0,hist=Rhaboo.persistent("fire-sauce");hist.channels||hist.write("channels",{}),hist.watching||hist.write("watching","");var ytScriptTag=document.createElement("script");ytScriptTag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(ytScriptTag,firstScriptTag);var ytplayer,ytplayerReady,ytIframeAPIReady,playerState=0,errorCodes={150:"This video is unavailable. Possible embedding disabled.",2:"This video ID is invalid."},loopEnabled=!0,markerWidth=0,prevCurrentTime=0,prevDuration=0,currentTime=0,tempCurrentTime=0,tempDuration=0,durationTimeOutput=0,currentTimeOutput=0,seekBarWidth,fractionLoaded,timeSeeking=!1,volSeeking=!1,completedPercent=0;